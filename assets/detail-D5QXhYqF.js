import{c as m,j as e,a as b,r as g}from"./index-776g7N3F.js";import{u as f}from"./useCourts-BP4xIMIC.js";import{D as M,M as _}from"./index-B0t3R4n8.js";import{u as I,a as z,b as D,g as y}from"./index-C1WcVVas.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],G=m("pause",P);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],$=m("play",O);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],q=m("square",R);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],j=m("x",A);function E({open:x,onOpenChange:r,onSelectMember:p}){const{members:i}=I(),{courts:c}=f(),n=c.flatMap(a=>a.players).filter(a=>a!==null).map(a=>a.id),o=i.filter(a=>a.status==="idle"&&!n.includes(a.id)),d=a=>{p(a),r(!1)};return e.jsxs(M,{open:x,onOpenChange:r,showFooter:!1,children:[e.jsx("h3",{className:"text-lg font-semibold mb-5 text-center",children:"選擇成員"}),e.jsx("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto",children:o.length>0?o.map(a=>e.jsx(_,{member:a,onClick:()=>d(a),selectingSlot:!0},a.id)):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"沒有可用的成員"})})]})}function X(){const x=b.useSearch().court_id,r=b.useNavigate(),[p,i]=g.useState(!1),[c,n]=g.useState(null),{courts:o,removePlayer:d,selectPlayer:a,randomGrouping:v,startGame:N,pauseGame:w,endGame:k}=f(),l=o.findIndex(t=>t.id===x),s=o[l],u=t=>{n({playerIndex:t}),i(!0)},C=t=>{c&&a(l,c.playerIndex,t),n(null)},S=()=>{N(l),r({to:"/courts"})},h=s?.players.filter(t=>t!==null).length===4;return e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:s?.name}),s&&e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${z(s.status)}`}),e.jsx("span",{className:"text-gray-600",children:D(s.status)})]})]}),e.jsx("button",{className:"text-indigo-600 text-sm font-medium",onClick:()=>r({to:"..",replace:!0}),children:"← 返回"})]}),e.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl p-6 mb-6 text-black",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"bg-white bg-opacity-10 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm opacity-80 mb-3 font-medium",children:"A隊"}),[0,1].map(t=>e.jsx("div",{className:"relative mb-2 last:mb-0",children:s?.players[t]?e.jsx("div",{className:"bg-white bg-opacity-20 rounded-lg px-2 py-1 text-lg font-medium",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"font-semibold",children:s.players[t].name}),e.jsx("span",{className:"text-sm opacity-80 ml-2",children:y(s.players[t].level)})]}),e.jsx("button",{className:"p-1 text-red-500 hover:text-red-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>d(l,t),disabled:s?.status==="playing",children:e.jsx(j,{size:28})})]})}):e.jsx("div",{className:"border border-dashed border-white border-opacity-50 rounded-lg py-3 px-2 text-center text-md text-black text-opacity-70 cursor-pointer hover:bg-white hover:bg-opacity-10 transition-colors",onClick:()=>u(t),children:"+ 選擇球員"})},t))]}),e.jsxs("div",{className:"bg-white bg-opacity-10 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm opacity-80 mb-3 font-medium",children:"B隊"}),[2,3].map(t=>e.jsx("div",{className:"relative mb-2 last:mb-0",children:s?.players[t]?e.jsx("div",{className:"bg-white bg-opacity-20 rounded-lg px-2 py-1 text-lg font-medium",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"font-semibold",children:s.players[t].name}),e.jsx("span",{className:"text-sm opacity-80 ml-2",children:y(s.players[t].level)})]}),e.jsx("button",{className:"p-1 text-red-500 hover:text-red-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>d(l,t),disabled:s?.status==="playing",children:e.jsx(j,{size:28})})]})}):e.jsx("div",{className:"border border-dashed border-white border-opacity-50 rounded-lg py-3 px-2 text-center text-md text-black text-opacity-70 cursor-pointer hover:bg-white hover:bg-opacity-10 transition-colors",onClick:()=>u(t),children:"+ 選擇球員"})},t))]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[s?.status!=="playing"&&e.jsx("button",{className:"flex-1 py-4 bg-gray-200 text-gray-800 font-semibold rounded-xl hover:bg-gray-300 transition-colors",onClick:()=>v(l),children:"隨機分組"}),s?.status==="waiting"&&h&&e.jsxs("button",{className:"flex-1 py-4 bg-green-500 text-white font-semibold rounded-xl hover:bg-green-600 transition-colors flex items-center justify-center gap-2",onClick:S,children:[e.jsx($,{size:16}),"開始比賽"]}),s?.status==="playing"&&e.jsxs("button",{className:"flex-1 py-4 bg-yellow-500 text-white font-semibold rounded-xl hover:bg-yellow-600 transition-colors flex items-center justify-center gap-2",onClick:()=>w(l),children:[e.jsx(G,{size:16}),"暫停比賽"]})]}),h&&s?.status==="playing"&&e.jsxs("button",{className:"w-full py-4 bg-red-500 text-white font-semibold rounded-xl hover:bg-red-600 transition-colors flex items-center justify-center gap-2",onClick:()=>k(l),children:[e.jsx(q,{size:16}),"結束比賽"]})]}),e.jsx(E,{open:p,onOpenChange:i,onSelectMember:C})]})}export{X as component};
