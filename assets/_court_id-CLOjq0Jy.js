import{c as j,j as e,a as h,r as b}from"./index-CqkVwgxY.js";import{u as f,P as S,S as M}from"./useCourts-DGTb2Z8s.js";import{D as P,M as I}from"./index-CZHRBG02.js";import{u as D,a as z,b as _,g}from"./index-sk7piHBK.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],O=j("pause",G);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],y=j("x",R);function E({open:m,onOpenChange:i,onSelectMember:x}){const{members:o}=D(),{courts:c}=f(),n=c.flatMap(a=>a.players).filter(a=>a!==null).map(a=>a.id),r=o.filter(a=>a.status==="idle"&&!n.includes(a.id)),d=a=>{x(a),i(!1)};return e.jsxs(P,{open:m,onOpenChange:i,showFooter:!1,children:[e.jsx("h3",{className:"text-lg font-semibold mb-5 text-center",children:"選擇成員"}),e.jsx("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto",children:r.length>0?r.map(a=>e.jsx(I,{member:a,onClick:()=>d(a),selectingSlot:!0},a.id)):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"沒有可用的成員"})})]})}function q(){const m=h.useParams().court_id,i=h.useNavigate(),[x,o]=b.useState(!1),[c,n]=b.useState(null),{courts:r,removePlayer:d,selectPlayer:a,randomGrouping:v,startGame:N,pauseGame:w,endGame:k}=f(),l=r.findIndex(s=>s.id===Number(m)),t=r[l],u=s=>{n({playerIndex:s}),o(!0)},C=s=>{c&&a(l,c.playerIndex,s),n(null)},p=t?.players.filter(s=>s!==null).length===4;return e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:t?.name}),t&&e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${z(t.status)}`}),e.jsx("span",{className:"text-gray-600",children:_(t.status)})]})]}),e.jsx("button",{className:"text-indigo-600 text-sm font-medium",onClick:()=>i({to:"..",replace:!0}),children:"← 返回"})]}),e.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl p-6 mb-6 text-black",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"bg-white bg-opacity-10 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm opacity-80 mb-3 font-medium",children:"A隊"}),[0,1].map(s=>e.jsx("div",{className:"relative mb-2 last:mb-0",children:t?.players[s]?e.jsx("div",{className:"bg-white bg-opacity-20 rounded-lg px-2 py-1 text-lg font-medium",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"font-semibold",children:t.players[s].name}),e.jsx("span",{className:"text-sm opacity-80 ml-2",children:g(t.players[s].level)})]}),e.jsx("button",{className:"p-1 text-red-500 hover:text-red-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>d(l,s),disabled:t?.status==="playing",children:e.jsx(y,{size:28})})]})}):e.jsx("div",{className:"border border-dashed border-white border-opacity-50 rounded-lg py-3 px-2 text-center text-md text-black text-opacity-70 cursor-pointer hover:bg-white hover:bg-opacity-10 transition-colors",onClick:()=>u(s),children:"+ 選擇球員"})},s))]}),e.jsxs("div",{className:"bg-white bg-opacity-10 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm opacity-80 mb-3 font-medium",children:"B隊"}),[2,3].map(s=>e.jsx("div",{className:"relative mb-2 last:mb-0",children:t?.players[s]?e.jsx("div",{className:"bg-white bg-opacity-20 rounded-lg px-2 py-1 text-lg font-medium",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"truncate",children:[e.jsx("span",{className:"font-semibold",children:t.players[s].name}),e.jsx("span",{className:"text-sm opacity-80 ml-2",children:g(t.players[s].level)})]}),e.jsx("button",{className:"p-1 text-red-500 hover:text-red-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>d(l,s),disabled:t?.status==="playing",children:e.jsx(y,{size:28})})]})}):e.jsx("div",{className:"border border-dashed border-white border-opacity-50 rounded-lg py-3 px-2 text-center text-md text-black text-opacity-70 cursor-pointer hover:bg-white hover:bg-opacity-10 transition-colors",onClick:()=>u(s),children:"+ 選擇球員"})},s))]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[t?.status!=="playing"&&e.jsx("button",{className:"flex-1 py-4 bg-gray-200 text-gray-800 font-semibold rounded-xl hover:bg-gray-300 transition-colors",onClick:()=>v(l),children:"隨機分組"}),t?.status==="waiting"&&p&&e.jsxs("button",{className:"flex-1 py-4 bg-green-500 text-white font-semibold rounded-xl hover:bg-green-600 transition-colors flex items-center justify-center gap-2",onClick:()=>N(l),children:[e.jsx(S,{size:16}),"開始比賽"]}),t?.status==="playing"&&e.jsxs("button",{className:"flex-1 py-4 bg-yellow-500 text-white font-semibold rounded-xl hover:bg-yellow-600 transition-colors flex items-center justify-center gap-2",onClick:()=>w(l),children:[e.jsx(O,{size:16}),"暫停比賽"]})]}),p&&t?.status==="playing"&&e.jsxs("button",{className:"w-full py-4 bg-red-500 text-white font-semibold rounded-xl hover:bg-red-600 transition-colors flex items-center justify-center gap-2",onClick:()=>k(l),children:[e.jsx(M,{size:16}),"結束比賽"]})]}),e.jsx(E,{open:x,onOpenChange:o,onSelectMember:C})]})}export{q as component};
