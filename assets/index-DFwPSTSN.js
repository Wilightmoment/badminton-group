import{c as k,r as o,j as e,R as P}from"./index-C7o_THua.js";import{u as S,S as D,P as M}from"./useCourts-CsmKn-mD.js";import{a as X,b as Y,T as z}from"./index-Bbi7oNZx.js";import{P as b}from"./plus-DrGkn5sB.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],R=k("shuffle",I),W=({actions:x})=>{const n=o.useRef(null),[c,l]=o.useState(!1),[i,d]=o.useState({x:window.innerWidth-16-56,y:window.innerHeight-150}),[u,m]=o.useState(!1),[h,t]=o.useState(!0),s=o.useRef({startX:0,startY:0,initialX:0,initialY:0,hasDragged:!1}),y=a=>{if(!n.current||a.target.closest("button")!==n.current?.querySelector(".fab-main-button")){a.target.closest(".fab-action-button")||l(!1);return}a.preventDefault(),n.current.setPointerCapture(a.pointerId),m(!0),t(!1),s.current={startX:a.clientX,startY:a.clientY,initialX:i.x,initialY:i.y,hasDragged:!1}},j=a=>{if(!u)return;const r=a.clientX-s.current.startX,g=a.clientY-s.current.startY;!s.current.hasDragged&&(Math.abs(r)>5||Math.abs(g)>5)&&(s.current.hasDragged=!0,c&&l(!1));let f=s.current.initialX+r,p=s.current.initialY+g;const N=n.current?.offsetWidth??64,C=n.current?.offsetHeight??64;f=Math.max(16,Math.min(f,window.innerWidth-N-16)),p=Math.max(16,Math.min(p,window.innerHeight-C-16)),d({x:f,y:p})},v=a=>{if(u)if(n.current?.releasePointerCapture(a.pointerId),m(!1),t(!0),!s.current.hasDragged)l(r=>!r);else{const r=n.current?.offsetWidth??64;i.x+r/2<window.innerWidth/2?d({x:16,y:i.y}):d({x:window.innerWidth-r-16,y:i.y})}},w={transform:`translate3d(${i.x}px, ${i.y}px, 0)`,transition:h?"transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)":"none"};return e.jsxs("div",{ref:n,className:"fixed top-0 left-0 z-50 select-none touch-none",style:w,onPointerDown:y,onPointerMove:j,onPointerUp:v,children:[c&&e.jsx("div",{className:"absolute bottom-full mb-4 flex flex-col items-center gap-4",children:x.map((a,r)=>e.jsxs("div",{className:"flex flex-col items-center gap-1 group relative",children:[e.jsx("span",{className:"bg-gray-800 text-white text-xs px-2 py-1 rounded-md absolute right-full mr-3 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:a.label}),e.jsx("button",{onClick:()=>{a.onClick(),l(!1)},className:"w-14 h-14 bg-white rounded-full shadow-lg flex items-center justify-center text-gray-700 hover:bg-gray-100 fab-action-button",children:a.icon})]},r))}),e.jsx("button",{className:"w-14 h-14 bg-indigo-600 rounded-full shadow-xl flex items-center justify-center text-white hover:bg-indigo-700 transition-transform duration-300 ease-in-out transform active:scale-95 fab-main-button",children:e.jsx(b,{size:32,className:`transition-transform duration-300 ${c?"rotate-45":""}`})})]})};function T(){const x=P.useNavigate(),{courts:n,fillIncompleteCourts:c,startAllReadyCourts:l,endAllPlayingCourts:i,addCourt:d,removeCourt:u}=S(),m=n.some(t=>t.status==="playing"),h=[{label:"補滿空位",icon:e.jsx(R,{size:24}),onClick:c},m?{label:"一鍵結束",icon:e.jsx(D,{size:24}),onClick:i}:{label:"一鍵開始",icon:e.jsx(M,{size:24}),onClick:l}];return e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"所有場地"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{className:"bg-indigo-500 cursor-pointer text-white px-3 py-2 rounded-full text-sm font-medium hover:bg-indigo-600 transition-colors items-center flex",onClick:d,children:[e.jsx(b,{size:14}),"新增場地"]})})]}),e.jsx("div",{className:"space-y-4",children:n.map(t=>e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:t.name}),e.jsxs("div",{className:"flex items-center gap-1 text-md",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${X(t.status)}`}),e.jsx("span",{className:"text-gray-600",children:Y(t.status)})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-red-600 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>u(t.id),disabled:t.status==="playing",children:e.jsx(z,{size:20})}),e.jsx("button",{className:"text-indigo-600 text-md font-medium hover:text-indigo-700 cursor-pointer",onClick:()=>{x({to:"/courts/$court_id",params:{court_id:t.id.toString()}})},children:"詳細 →"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-md text-blue-700 font-medium mb-2",children:"A隊"}),[0,1].map(s=>e.jsx("div",{className:"text-md mb-1 last:mb-0 text-gray-700 truncate",children:t.players[s]?`• ${t.players[s].name}`:"• 空位"},s))]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-md text-purple-700 font-medium mb-2",children:"B隊"}),[2,3].map(s=>e.jsx("div",{className:"text-md mb-1 last:mb-0 text-gray-700 truncate",children:t.players[s]?`• ${t.players[s].name}`:"• 空位"},s))]})]})]},t.id))}),e.jsx(W,{actions:h})]})}export{T as component};
